# å¸ˆèµ„åŸ¹è®­è¯¾ä»¶ï¼ˆDOM æ“ä½œé¢˜ç›®ï¼‰

### 1. åä¸‰å±Šçœèµ›å¥èº«å¤§è°ƒæŸ¥

```js
let placeValuesMap = new Map([
  ["1", "å…¬å›­"],
  ["2", "å¥èº«æˆ¿"],
  ["3", "æˆ·å¤–"],
]);
const males = ["ç”·", "å¥³"];

function formSubmit() {
  var formData = new FormData(myForm);
  let height = formData.get("height");
  let weight = formData.get("weight");
  let male = formData.get("male");
  let places = formData.getAll("place");
  places = places.map((placeValue) => placeValuesMap.get(placeValue));
  placeStr = places.join(",");
  // è¡¨å•é¡¹éšè—
  quescontent.style.display = "none";
  // ç»“æœé¡¹ç›®æ˜¾ç¤º
  result.style.display = "block";
  resultStr = `èº«é«˜${height}cmï¼Œä½“é‡ ${weight}kg ï¼Œæ€§åˆ« ${males[male]}ï¼Œä¼šåœ¨${placeStr}å¥èº«é”»ç‚¼ã€‚`;
  result.innerText += `\r\n${resultStr}`;
}
```


### 2. åä¸‰å±Šçœèµ›è¯¾ç¨‹åˆ—è¡¨

```js
let pageSize = 5; // æ¯é¡µæ¡æ•°
let pageNum = 1; // é»˜è®¤é¡µç 
let pagereuslt; // æ¥æ”¶è¯·æ±‚è¿”å›çš„æ•°æ®
let maxPage; // æœ€å¤§é¡µæ•°
let pageData; // å½“å‰é¡µæ˜¾ç¤ºçš„æ•°æ®
// æ˜¾ç¤ºæœ€å¤§é¡µæ•°å’Œå½“å‰æ˜¯ç¬¬å‡ é¡µ
function pagefun(maxPage, pageNum) {
  pagination.innerHTML = `å…± ${maxPage}  é¡µï¼Œå½“å‰ ${pageNum} é¡µ`;
}
// å°†æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Š
function renderHtml(pageData) {
  list.innerHTML = pageData
    .map((item) => {
      return `<div class="list-group">
						<a href="#" class="list-group-item list-group-item-action">
				   		 	<div class="d-flex w-100 justify-content-between">
				       			<h5 class="mb-1">${item.name}</h5>
					  	 		 <small>${(item.price / 100).toFixed(2)}å…ƒ</small>
							</div>
							<p class="mb-1">${item.description}</p>
						</a>
				</div>`;
    })
    .join("");
}
// é€šè¿‡ axios è·å–æ•°æ®
axios.get("./js/carlist.json").then((res) => {
  console.log(res.data);
  pagereuslt = res.data;

  pageData = pagereuslt.slice((pageNum - 1) * pageSize, pageNum * pageSize);
  renderHtml(pageData);
  maxPage = Math.ceil(pagereuslt.length / pageSize);
  pagefun(maxPage, pageNum);
});
// ç‚¹å‡»è·å–ä¸‹ä¸€é¡µæ•°æ®
prev.onclick = function () {
  next.classList.remove("disabled");
  pageNum = pageNum - 1;
  if (pageNum <= 1) {
    prev.classList.add("disabled");
    pageNum = 1;
  }
  pageData = pagereuslt.slice((pageNum - 1) * pageSize, pageNum * pageSize);
  renderHtml(pageData);
  pagefun(maxPage, pageNum);
};
// ç‚¹å‡»ä¸‹ä¸€é¡µ
next.onclick = function () {
  prev.classList.remove("disabled");
  pageNum = pageNum + 1;
  if (pageNum >= maxPage) {
    pagnum = maxPage;
    next.classList.add("disabled");
  }
  pageData = pagereuslt.slice((pageNum - 1) * pageSize, pageNum * pageSize);
  renderHtml(pageData);
  pagefun(maxPage, pageNum);
};

```

### 3. åä¸‰å±Šå›½èµ›æ–°å¢åœ°å€

```js
// åˆå§‹åŒ–çœä»½ä¸‹æ‹‰åˆ—è¡¨å†…å®¹
function provinceInit() {
  var province = document.getElementById("param_province");
  province.length = provinces.length;
  for (var i = 0; i < provinces.length; i++) {
    province.options[i].text = provinces[i];
    province.options[i].value = provinces[i];
  }
}

// é€‰æ‹©çœä»½åå¯¹åº”åŸå¸‚ä¸‹æ‹‰åˆ—è¡¨å†…å®¹æ¸²æŸ“
function provincechange() {
  var province = document.getElementById("param_province");
  var num = province.selectedIndex; // é€‰ä¸­ option ç´¢å¼•
  var city = document.getElementById("param_city");
  var citystemp = citys[num];
  city.length = citystemp.length;
  for (var i = 0; i < citystemp.length; i++) {
    city.options[i].text = citystemp[i];
    city.options[i].value = citystemp[i];
  }
  city.options[0].selected = true;
}

/**
 * ä¸ºæ ‡ç­¾ç»‘å®šå•å‡»äº‹ä»¶ã€‚
 * äº‹ä»¶æ•ˆæœä¸ºï¼š
 * 1ã€é¼ æ ‡ç‚¹å‡»è¯¥æ ‡ç­¾åè¯¥æ ‡ç­¾æ ·å¼æ˜¾ç¤º class=activeï¼›
 * 2ã€å…¶ä»–å·²é€‰æ ‡ç­¾çš„ active æ ·å¼è¢«ç§»é™¤ï¼›
 * 3ã€å°†é€‰ä¸­çš„æ ‡ç­¾å¯¹åº”ä¸‹æ ‡ï¼ˆå³é€‰æ‹©å™¨ä¸º â€œmark aâ€ é€‰ä¸­çš„æ ‡ç­¾å¯¹åº”çš„ä¸‹æ ‡ï¼‰æ›´æ–°åˆ° id=param_mark çš„éšè—çš„ input ä¸­ã€‚
 */
function addClick() {
  var markList = document.querySelectorAll(".mark a");
  for (var i = 0; i < markList.length; i++) {
    (function (index) {
      markList[i].onclick = function () {
        this.className = "active";
        for (var j = 0; j < markList.length; j++) {
          if (j != index) {
            markList[j].className = "";
          }
        }
        document.getElementById("param_mark").value = index;
      };
    })(i);
  }
}
// æäº¤ä¿¡æ¯åï¼Œè¯»å–å¹¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸­
function saveInfo() {
  var province = document.getElementById("param_province").value;
  var city = document.getElementById("param_city").value;
  var address = document.getElementById("param_address").value;
  var mark = document.getElementById("param_mark").value;
  var name = document.getElementById("param_name").value;
  var phone = document.getElementById("param_phone").value;

  if (!province || !city || !address || !name || !phone) {
    document.querySelector(".warning-dialog").style.display = "block";
    return false;
  }

  document.getElementById("main_title").innerHTML = "åœ°å€ç®¡ç†";
  document.querySelector(".address").style.display = "none";
  document.querySelector(".user-info").style.display = "none";

  var markClass = "";
  var markInfo = "";
  switch (mark) {
    case "0":
      markClass = "home";
      markInfo = "å®¶";
      break;
    case "1":
      markClass = "company";
      markInfo = "å…¬å¸";
      break;
    case "2":
      markClass = "school";
      markInfo = "å­¦æ ¡";
      break;
  }

  var addressInfoStr = `<li>
    <div class="show-area">
      ${markInfo ? `<label class="${markClass}">${markInfo}</label>` : ""}
      <span>${province + city}</span>
    </div>
    <div class="show-address">
      <span>${address}</span>
      <a><img src="./images/edit.png" /></a>
    </div>
    <div class="show-info">
      <span>${name}</span>
      <span>${phone}</span>
    </div>
  </li>`;
  document.querySelector(".address-list").innerHTML =
    addressInfoStr + document.querySelector(".address-list").innerHTML;
  document.querySelector(".address-list").style.display = "block";
}

// åˆ‡æ¢æ–°å¢åœ°å€å’Œåœ°å€ç®¡ç†çš„æ˜¾éš
function back() {
  if (document.getElementById("main_title").innerHTML == "åœ°å€ç®¡ç†") {
    document.getElementById("main_title").innerHTML = "æ–°å¢åœ°å€";
    document.querySelector(".address-list").style.display = "none";
    document.querySelector(".address").style.display = "block";
    document.querySelector(".user-info").style.display = "block";
  }
}
// é¡µé¢åŠ è½½åçš„åˆå§‹åŒ–æ“ä½œ
function init() {
  // åˆå§‹åŒ–çœä»½ä¸‹æ‹‰åˆ—è¡¨å†…å®¹
  provinceInit();
  // ä¸ºæ ‡ç­¾ç»‘å®šå•å‡»äº‹ä»¶
  addClick();
}

window.onload = function () {
  // åˆå§‹åŒ–
  init();
};

```

### 4. åå››å±Šçœèµ›å›¾ç‰‡æ°´å°ç”Ÿæˆ	

- è€ƒå¯Ÿï¼š dom æ“ä½œã€css ã€ css3 å¸¸â»…å±æ€§

```js
// é€šè¿‡ for å¾ªç¯â½£æˆæŒ‡å®šæ•°é‡çš„ span å…ƒç´ ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°å®¹å™¨ä¸­
for (let index = 0; index < count; index++) {
  // ä½¿â½¤ä¼ â¼Šçš„å‚æ•°è®¾ç½® span å…ƒç´ çš„â½‚æœ¬å†…å®¹ã€é¢œâ¾Šã€æ—‹è½¬â»†åº¦å’Œé€æ˜åº¦ï¼Œå¹¶æ·»åŠ åˆ°å®¹å™¨ä¸­
  container.innerHTML += `<span style="color:${color};transform: rotate(${deg}deg);opacity:${opacity}">${text}</span>`;
  // è¿”å›æ·»åŠ äº† span å…ƒç´ çš„å®¹å™¨
}
```

ç­”æ¡ˆ 2 ï¼š

```js
// ä½¿â½¤ repeat() â½…æ³•åˆ›å»ºâ¼€ä¸ªåŒ…å«æŒ‡å®šæ•°é‡ span å…ƒç´ çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸ºæ¯ä¸ªå…ƒç´ è®¾ç½®â½‚æœ¬å†…å®¹ã€é¢œâ¾Šã€æ—‹è½¬â»†åº¦å’Œ
const spans =
  `<span style="color:${color};transform: rotate(${deg}deg);opacity:${opacity}">${text}</span>`.repeat(count);
// å°†åŒ…å«æ‰€æœ‰ span å…ƒç´ çš„å­—ç¬¦ä¸²æ·»åŠ åˆ°å®¹å™¨ä¸­
container.innerHTML = spans;
// è¿”å›æ·»åŠ äº† span å…ƒç´ çš„å®¹å™¨
return container;
```
### 5. åå››å±Šçœèµ›å¹´åº¦æ˜æ˜Ÿé¡¹ç›®	

```js
let translation = {};
const data = [];
// è®°å½•å½“å‰å±•ç¤ºçš„é¡¹ç›®æ•°é‡
let cursor = 15;
// è®°å½•å½“å‰è¯­è¨€
let currLang = "zh-cn";

// è¯·æ±‚é¡¹ç›®æ•°æ®ï¼Œå±•ç¤ºå‰50ä¸ª
$.ajax({
  url: "./js/all-data.json",
  success: (result) => {
    data.push(...result);
    data.slice(0, 15).forEach((item) => {
      $(".list > ul").append(
        createItem({ ...item, description: item.descriptionCN })
      );
    });
  },
});

// è¯·æ±‚ç¿»è¯‘æ•°æ®
$.ajax({
  url: "./js/translation.json",
  success: (result) => {
    translation = result;
  },
});

// ç”¨æˆ·ç‚¹å‡»åŠ è½½æ›´å¤šæ—¶
$(".load-more").click(() => {
  console.log(data.length);
  if (cursor < data.length) {
    data.slice(cursor, (cursor += 15)).forEach((item) => {
      $(".list > ul").append(
        createItem({
          ...item,
          description:
            currLang === "zh-cn" ? item.descriptionCN : item.descriptionEN,
        })
      );
    });
  }
  if (cursor === data.length) {
    $(".load-more").hide();
  }
});

$(".lang").click(() => {
  if (currLang === "en") {
    $(".lang").text("English");
    currLang = "zh-cn";
  } else {
    $(".lang").text("ä¸­æ–‡");
    currLang = "en";
  }
  $(".list > ul").empty();
  data.slice(0, cursor).forEach((item) => {
    $(".list > ul").append(
      createItem({
        ...item,
        description:
          currLang === "zh-cn" ? item.descriptionCN : item.descriptionEN,
      })
    );
  });
  $("body")
    .find("*")
    .each(function () {
      const text = $(this).text().trim();
      if (translation[text]) {
        $(this).text(translation[text]);
      }
    });
});

function createItem({ name, description, tags, stars, icon }) {
  return `
    <li class="item">
      <img src="images/${icon}" alt="">
      <div class="desc">
        <h3>${name}</h3>
        <p>${description}</p>
        <ul class="labels">
          ${tags.map((tag) => `<li>${tag}</li>`).join("")}
        </ul>
      </div>
      <div class="stars">
        +${stars} ğŸŒŸ
      </div>
    </li>
  `;
}

```
### 6. åå››å±Šçœèµ›è§†é¢‘å¼¹å¹•	

```js
const bullets = [
  "å‰æ–¹é«˜èƒ½",
  "åŸæ¥å¦‚æ­¤",
  "è¿™ä¹ˆç®€å•",
  "å­¦åˆ°äº†",
  "å­¦è´¹äº†",
  "666666",
  "111111",
  "workerman",
  "å­¦ä¹ äº†",
  "åˆ«èµ°ï¼Œå¥‹æ–—åˆ°å¤©æ˜",
];

/**
 * @description æ ¹æ® bulletConfig é…ç½®åœ¨ videoEle å…ƒç´ æœ€å³è¾¹ç”Ÿæˆå¼¹å¹•ï¼Œå¹¶ç§»åŠ¨åˆ°æœ€å·¦è¾¹ï¼Œå¼¹å¹•æœ€åæ¶ˆå¤±
 * @param {Object} bulletConfig å¼¹å¹•é…ç½®
 * @param {Element} videoEle è§†é¢‘å…ƒç´ 
 * @param {boolean} isCreate æ˜¯å¦ä¸ºæ–°å¢å‘é€çš„å¼¹å¹•ï¼Œä¸º true è¡¨ç¤ºä¸ºæ–°å¢çš„å¼¹å¹•
 *
 */
function renderBullet(bulletConfig, videoEle, isCreate = false) {
  const spanEle = document.createElement("SPAN");
  spanEle.classList.add(`bullet${index}`);
  if (isCreate) {
    spanEle.classList.add("create-bullet");
  }
  // TODOï¼šæ§åˆ¶å¼¹å¹•çš„æ˜¾ç¤ºé¢œè‰²å’Œç§»åŠ¨ï¼Œæ¯éš” bulletConfig.time æ—¶é—´ï¼Œå¼¹å¹•ç§»åŠ¨çš„è·ç¦»  bulletConfig.speed
  spanEle.innerText = bulletConfig.value;
  const { width: videoEleWidth, height: videoEleHeight } =
    getEleStyle(videoEle);
  let color = `RGB(${getRandomNum(255)},${getRandomNum(255)}, ${getRandomNum(
    255
  )})`;

  spanEle.style.left = `${videoEleWidth}px`;
  spanEle.style.top = `${getRandomNum(videoEleHeight - 100).toFixed(2)}px`;
  spanEle.style.color = color;

  let spanEleLeft = videoEleWidth;
  videoEle.appendChild(spanEle);
  const { width: spanEleWidth } = getEleStyle(spanEle);
  let timer = setInterval(() => {
    spanEleLeft -= bulletConfig.speed;
    spanEle.style.left = `${
      spanEleLeft + spanEleWidth >= 0 ? spanEleLeft : 0
    }px`;
    if (bulletConfig.isHide || spanEleLeft + spanEleWidth < 0) {
      videoEle.removeChild(spanEle);
      clearInterval(timer);
    }
  }, bulletConfig.time);
}

document.querySelector("#sendBulletBtn").addEventListener("click", () => {
  // TODO:ç‚¹å‡»å‘é€æŒ‰é’®ï¼Œè¾“å…¥æ¡†ä¸­çš„æ–‡å­—å‡ºç°åœ¨å¼¹å¹•ä¸­
  bulletConfig.value = document.querySelector("#bulletContent").value;
  if (isPlay && bulletConfig.value != "") {
    renderBullet(bulletConfig, videoEle, true);
  }
  document.querySelector("#bulletContent").value = "";
});

function getEleStyle(ele) {
  // è·å¾—å…ƒç´ çš„width,height,left,right,top,bottom
  return ele.getBoundingClientRect();
}

function getRandomNum(end, start = 0) {
  // è·å¾—éšæœºæ•°ï¼ŒèŒƒå›´æ˜¯ ä»startåˆ° end
  return Math.floor(start + Math.random() * (end - start + 1));
}

// è®¾ç½® index æ˜¯ä¸ºäº†å¼¹å¹•æ•°ç»„å¾ªç¯æ»šåŠ¨
let index = 0;
const videoEle = document.querySelector("#video");
// å¼¹å¹•é…ç½®
const bulletConfig = {
  isHide: false, // æ˜¯å¦éšè—
  speed: 5, // å¼¹å¹•çš„ç§»åŠ¨è·ç¦»
  time: 50, // å¼¹å¹•æ¯éš”å¤šå°‘msç§»åŠ¨ä¸€æ¬¡
};
let isPlay = false;
let timer;
document.querySelector("#vd").addEventListener("play", () => {
  isPlay = true;
  bulletConfig.value = bullets[index++];
  renderBullet(bulletConfig, videoEle);
  timer = setInterval(() => {
    bulletConfig.value = bullets[index++];
    renderBullet(bulletConfig, videoEle);
    if (index >= bullets.length) {
      index = 0;
    }
  }, 1000);
});

document.querySelector("#vd").addEventListener("pause", () => {
  isPlay = false;
  clearInterval(timer);
});

document.querySelector("#switchButton").addEventListener("change", (e) => {
  if (e.target.checked) {
    bulletConfig.isHide = false;
  } else {
    bulletConfig.isHide = true;
  }
});

```
### 7. åå››å±Šçœèµ›ç»„è¯¾ç¥å™¨

```js
/**
 * @description æ¨¡æ‹Ÿ ajax è¯·æ±‚ï¼Œæ‹¿åˆ°æ ‘å‹ç»„ä»¶çš„æ•°æ® treeData
 * @param {string} url è¯·æ±‚åœ°å€
 * @param {string} method è¯·æ±‚æ–¹å¼ï¼Œå¿…å¡«ï¼Œé»˜è®¤ä¸º get
 * @param {string} data è¯·æ±‚ä½“æ•°æ®ï¼Œå¯é€‰å‚æ•°
 * @return {Array}
 * */
async function ajax({ url, method = "get", data }) {
  let result;
  // TODOï¼šæ ¹æ®è¯·æ±‚æ–¹å¼ method ä¸åŒï¼Œæ‹¿åˆ°æ ‘å‹ç»„ä»¶çš„æ•°æ®
  // å½“method === "get" æ—¶ï¼ŒlocalStorage å­˜åœ¨æ•°æ®ä» localStorage ä¸­è·å–ï¼Œä¸å­˜åœ¨åˆ™ä» /js/data.json ä¸­è·å–
  // å½“method === "post" æ—¶ï¼Œå°†æ•°æ®ä¿å­˜åˆ°localStorage ä¸­
  if (method === "get") {
    let res;
    if (localStorage.getItem("data")) {
      result = JSON.parse(localStorage.getItem("data"));
    } else {
      data = await axios({ url, method, data });
      res = data.data;
      result = res.data;
    }
  }
  if (method === "post") {
    localStorage.setItem("data", JSON.stringify(data));
  }
  return result;
}

/**
 * @description æ‰¾åˆ°å…ƒç´ èŠ‚ç‚¹çš„çˆ¶äº²å…ƒç´ ä¸­ç±»é€‰æ‹©å™¨ä¸­å«æœ‰ tree-node çš„å…ƒç´ èŠ‚ç‚¹
 * @param {Element} node ä¼ å…¥çš„å…ƒç´ èŠ‚ç‚¹
 * @return {Element} å¾—åˆ°çš„å…ƒç´ èŠ‚ç‚¹
 */
const getTreeNode = (node) => {
  let curElement = node;
  while (!curElement.classList.contains("tree-node")) {
    if (curElement.classList.contains("tree")) {
      break;
    }
    curElement = curElement.parentNode;
  }
  return curElement;
};

/**
 * @description æ ¹æ® dragElementId, dropElementId é‡æ–°ç”Ÿæˆæ‹–æ‹½å®Œæˆåçš„æ ‘å‹ç»„ä»¶çš„æ•°æ® treeData
 * @param {number} dragGrade è¢«æ‹–æ‹½çš„å…ƒç´ çš„ç­‰çº§ï¼Œå€¼ä¸º dragElement data-gradeå±æ€§å¯¹åº”çš„å€¼
 * @param {number} dragElementId è¢«æ‹–æ‹½çš„å…ƒç´ çš„idï¼Œå€¼ä¸ºå½“å‰æ•°æ®å¯¹åº”åœ¨ treeData ä¸­çš„id
 * @param {number} dropGrade æ”¾å…¥çš„ç›®æ ‡å…ƒç´ çš„ç­‰çº§ï¼Œå€¼ä¸º dropElement data-gradeå±æ€§å¯¹åº”çš„å€¼
 * @param {number} dropElementId æ”¾å…¥çš„ç›®æ ‡å…ƒç´ çš„idï¼Œå€¼ä¸ºå½“å‰æ•°æ®å¯¹åº”åœ¨ treeData ä¸­çš„id
 */
function treeDataRefresh(
  { dragGrade, dragElementId },
  { dropGrade, dropElementId }
) {
  if (dragElementId === dropElementId) return;
  // TODOï¼šæ ¹æ® `dragElementId, dropElementId` é‡æ–°ç”Ÿæˆæ‹–æ‹½å®Œæˆåçš„æ ‘å‹ç»„ä»¶çš„æ•°æ® `treeData`
  const getAndDeleteDragLabelObj = (dragElementId, data) => {
    let result;
    if (dragGrade - dropGrade > 1 || dragGrade - dropGrade < 0) return result;
    const innerFn = (dragElementId, data) => {
      data.forEach((treeObj, index, array) => {
        if (treeObj.id === Number(dragElementId)) {
          array.splice(index, 1);
          result = treeObj;
        } else {
          treeObj.children && innerFn(dragElementId, treeObj.children);
        }
      });
    };
    innerFn(dragElementId, data);
    return result;
  };
  const setDragLabelObjToTreeData = (dragLabelObj, dropElementId, data) => {
    for (let i = 0; i < data.length; i++) {
      const treeObj = data[i];
      if (treeObj.id === Number(dropElementId)) {
        if (dragGrade - dropGrade == 1) {
          treeObj.children
            ? treeObj.children.unshift(dragLabelObj)
            : (treeObj["children"] = [dragLabelObj]);
        } else if (dragGrade - dropGrade == 0) {
          data.splice(i + 1, 0, dragLabelObj);
          break;
        }
      } else {
        treeObj.children &&
          setDragLabelObjToTreeData(
            dragLabelObj,
            dropElementId,
            treeObj.children
          );
      }
    }
  };
  let dragLabelObj = getAndDeleteDragLabelObj(dragElementId, treeData);
  if (dropElementId) {
    dragLabelObj &&
      setDragLabelObjToTreeData(dragLabelObj, dropElementId, treeData);
  } else {
    treeData.unshift(dragLabelObj);
  }
}

/**
 * @description æ ¹æ® treeData çš„æ•°æ®ç”Ÿæˆæ ‘å‹ç»„ä»¶çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œåœ¨åŒ…å« .tree-node çš„å…ƒç´ èŠ‚ç‚¹éœ€è¦åŠ ä¸Š data-grade=${index}è¡¨ç¤ºèœå•çš„å±‚çº§ data-index="${id}" è¡¨ç¤ºèœå•çš„å”¯ä¸€id
 * @param {array} data treeData æ•°æ®
 * @param {number} grade èœå•çš„å±‚çº§
 * @return æ ‘å‹ç»„ä»¶çš„æ¨¡æ¿å­—ç¬¦ä¸²
 *
 * */
function treeMenusRender(data, grade = 0) {
  let treeTemplate = "";
  // TODOï¼šæ ¹æ®ä¼ å…¥çš„ treeData çš„æ•°æ®ç”Ÿæˆæ ‘å‹ç»„ä»¶çš„æ¨¡æ¿å­—ç¬¦ä¸²
  grade++;
  return data.reduce((prev, cur) => {
    let isContainChild = !!cur.children;
    return (treeTemplate += `
        <div class="tree-node"  data-grade=${grade} data-index="${cur.id}">
            <div class="tree-node-content" style="margin-left:${
              (grade - 1) * 15
            }px">
                <div class="tree-node-content-left">
                    <img src="https://static.shiyanlou.com/opcenter-fe/frontend/dist/img/icon-dragger.2c0734b.svg"  class="point-svg">
                    ${
                      cur.tag
                        ? `<span class="tree-node-tag" >${cur.tag}</span>`
                        : ""
                    }
                    <span class="tree-node-label">${cur.label}</span>
                    ${
                      isContainChild
                        ? `<img class="config-svg" src="https://static.shiyanlou.com/opcenter-fe/frontend/dist/img/icon-setting.4ab65af.svg">`
                        : ""
                    }
                </div>

                ${
                  !isContainChild
                    ? `<div class="tree-node-content-right">
                        <div class="students-count">
                            <span class="number">0äººå®Œæˆ</span>
                            <span class="line">|</span>
                            <span class="number">0äººæäº¤æŠ¥å‘Š</span>
                        </div>
                        <div class="config">
                            <img class="config-svg"
                                src="https://static.shiyanlou.com/opcenter-fe/frontend/dist/img/icon-setting.4ab65af.svg"
                                alt="">
                            <button class="doc-link">ç¼–è¾‘æ–‡æ¡£</button>
                        </div>
                    </div>`
                    : ""
                }
            </div>
            ${
              isContainChild
                ? `<div class="tree-node-children">
                    ${isContainChild && treeMenusRender(cur.children, grade)}
                </div>`
                : ""
            }
        </div>    
        `);
  }, "");
}

let treeData; // æ ‘å‹ç»„ä»¶çš„æ•°æ® treeData

// æ‹–æ‹½åˆ°ç›®æ ‡å…ƒç´ æ”¾ä¸‹åæ‰§è¡Œçš„å‡½æ•°
const dropHandler = (dragElement, dropElement) => {
  let dragElementId = dragElement.dataset.index;
  let dragGrade = dragElement.dataset.grade;
  if (dropElement) {
    let dropElementId = dropElement.dataset.index;
    let dropGrade = dropElement.dataset.grade;

    treeDataRefresh({ dragGrade, dragElementId }, { dropGrade, dropElementId });
    document.querySelector(".tree").innerHTML = treeMenusRender(treeData);
    document.querySelector("#test").innerText = treeData
      ? JSON.stringify(treeData)
      : "";
    ajax({ url: "./js/data.json", method: "post", data: treeData });
  }
};
// åˆå§‹åŒ–
ajax({ url: "./js/data.json" }).then((res) => {
  treeData = res;
  document.querySelector("#test").innerText = treeData
    ? JSON.stringify(treeData)
    : "";
  let treeEle = document.querySelector(".tree");
  treeEle.dataset.grade = 0;
  let treeTemplate = treeMenusRender(treeData);
  treeTemplate && (treeEle.innerHTML = treeTemplate);
  const mDrag = new MDrag(".tree-node", dropHandler);
  // äº‹ä»¶å§”æ‰˜ï¼ŒæŒ‰ä¸‹å°å›¾æ ‡è®°å½•å¾—åˆ°è¢«æ‹–æ‹½çš„å…ƒç´ ï¼Œè¯¥å…ƒç´  class åŒ…å« .tree-node
  document.querySelector(".tree").addEventListener("mousedown", (e) => {
    e.preventDefault();
    if (
      e.target.nodeName.toLowerCase() === "img" &&
      e.target.classList.contains("point-svg")
    ) {
      let dragElement = getTreeNode(e.target);
      // MDragç±»çš„dragæ–¹æ³•å®ç°æ‹–æ‹½æ•ˆæœ
      mDrag.drag(e, dragElement);
    }
  });
});

/**
 * @description å®ç°æ‹–æ‹½åŠŸèƒ½çš„ç±»ï¼Œè¯¥ç±»çš„åŠŸèƒ½ä¸ºæ¨¡æ‹Ÿ HTML5 drag çš„åŠŸèƒ½
 *              é¼ æ ‡æŒ‰ä¸‹åï¼Œç›‘å¬ document çš„ mousemove å’Œ mouseup äº‹ä»¶
 *              å½“å¼€å§‹æ‹–æ‹½ä¸€ä¸ªå…ƒç´ åä¼šåœ¨ body å†…æ’å…¥å¯¹åº”çš„å…‹éš†å…ƒç´ ï¼Œå¹¶éšç€é¼ æ ‡çš„ç§»åŠ¨è€Œç§»åŠ¨
 *              é¼ æ ‡æŠ¬èµ·åï¼Œç§»é™¤å…‹éš†å…ƒç´ å’Œ mousemove äº‹ä»¶ï¼Œå¦‚æœåˆ°è¾¾ç›®æ ‡è§¦å‘ä¼ å…¥çš„ dropHandler æ–¹æ³•
 */
class MDrag {
  constructor(dropElementSelector, dropHandler) {
    // ç›®æ ‡å…ƒç´ çš„é€‰æ‹©å™¨
    this.dropElementSelector = dropElementSelector;
    // æ‹–æ‹½åˆ°ç›®æ ‡å…ƒç´ æ”¾ä¸‹åæ‰§è¡Œçš„å‡½æ•°
    this.dropHandler = dropHandler;

    // ä¿å­˜æ‰€æœ‰çš„ç›®æ ‡å…ƒç´ 
    this.dropBoundingClientRectArr = [];
    // è¢«æ‹–æ‹½çš„å…ƒç´ 
    this._dragElement = null;
    // æ‹–æ‹½ä¸­ç§»åŠ¨çš„å…ƒç´ 
    this._dragElementClone = null;
    // ç›®æ ‡å…ƒç´ 
    this._dropElement = null;
    // æ‹–æ‹½ç§»åŠ¨äº‹ä»¶
    this._dragMoveBind = null;
    // æ‹–æ‹½é¼ æ ‡æŠ¬èµ·äº‹ä»¶
    this._dragUpBind = null;

    this.init();
  }
  init() {
    const dropElements = document.querySelectorAll(this.dropElementSelector);
    this.dropBoundingClientRectArr = Array.from(dropElements).map((el) => {
      return { boundingClientRect: el.getBoundingClientRect(), el };
    });
  }
  dragMove(e) {
    const { pageX, pageY } = e;
    this._dragElementClone.style.left = `${e.pageX}px`;
    this._dragElementClone.style.top = `${e.pageY}px`;
    this.setMouseOverElementStyle(pageX, pageY);
  }
  dragend(e) {
    // ç§»åŠ¨åˆ°ç›®æ ‡å…ƒç´ åmouseupäº‹ä»¶è§¦å‘ï¼Œåˆ é™¤ this._dragElementClone å…ƒç´ å’Œè§£é™¤mousemove/mouseupäº‹ä»¶
    const { pageX, pageY } = e;
    document.removeEventListener("mousemove", this._dragMoveBind);
    document.removeEventListener("mouseup", this._dragUpBind);
    if (
      Array.from(document.body.children).indexOf(this._dragElementClone) != -1
    ) {
      document.body.removeChild(this._dragElementClone);
    }
    this._dropElement = this.getActualDropElement(pageX, pageY);
    this.drop();
  }
  drag(e, dragElement) {
    this._dragElement = dragElement;
    this._dragElementClone = dragElement.cloneNode(true);
    this._dragElementClone.style.position = "absolute";
    this._dragElementClone.style.left = `${e.pageX - 20}px`;
    this._dragElementClone.style.top = `${e.pageY - 20}px`;
    this._dragElementClone.style.opacity = 0.5;
    this._dragElementClone.style.width = "800px";
    document.body.appendChild(this._dragElementClone);
    // ç»‘å®šmousemoveå’Œmouseupäº‹ä»¶
    this._dragMoveBind = this.dragMove.bind(this);
    this._dragUpBind = this.dragend.bind(this);
    document.addEventListener("mousemove", this._dragMoveBind);
    document.addEventListener("mouseup", this._dragUpBind);
    return this;
  }
  getActualDropElement(pageX, pageY) {
    const dropAttributeArr = this.dropBoundingClientRectArr.filter(
      (obj) =>
        pageY >= obj.boundingClientRect.top &&
        pageY <= obj.boundingClientRect.top + obj.boundingClientRect.height
    );
    if (dropAttributeArr.length == 1) {
      return dropAttributeArr[0].el;
    } else if (dropAttributeArr.length > 1) {
      let temp = dropAttributeArr.reduce((prev, next) => {
        if (
          Math.abs(pageY - prev.boundingClientRect.top) <=
          Math.abs(pageY - next.boundingClientRect.top)
        ) {
          return prev;
        } else {
          return next;
        }
      });
      return temp.el;
    } else {
      return null;
    }
  }
  setMouseOverElementStyle(pageX, pageY) {
    let mousemoveEle = this.getActualDropElement(pageX, pageY);
    if (mousemoveEle) {
      this.dropBoundingClientRectArr.forEach((obj) => {
        obj.el.classList.contains("mouseover-active") &&
          obj.el.classList.remove("mouseover-active");
      });
      mousemoveEle.classList.add("mouseover-active");
    }
  }
  drop() {
    this.dropHandler && this.dropHandler(this._dragElement, this._dropElement);
    this.init();
  }
}
```
### 8. åå››å±Šå›½èµ›æ–‡æœ¬æŸ¥é‡å°èƒ½æ‰‹
```js
// index.js
let articles;
// è·å– select ä¸‹æ‹‰å…ƒç´ 
const articleSelect = document.getElementById("articleSelect");

// è·å–æŸ¥é‡æŒ‰é’®å…ƒç´ 
const checkPlagiarismEl = document.getElementById("checkPlagiarism");
// è·å–åŸæ–‡
const originalText = document.getElementById("originalText").value;
// è·å–æ˜¾ç¤ºé‡å¤ç‡çš„å…ƒç´ 
const plagiarismRateText = document.getElementById("plagiarismRateText");

// è·å–å¯¹æ¯”æ–‡ç« æ–‡æœ¬æ¡†
const compareText = document.getElementById("compareText");

// è¯·æ±‚æ–‡ç« æ•°æ®
fetch("./data.json")
  .then((response) => response.json())
  .then((res) => {
    articles = res.data;
    compareText.value = articles[`articleOne`];
  })
  .catch((error) => console.error(error));
// åˆ‡æ¢æ–‡ç« 
articleSelect.addEventListener("change", function () {
  const selectedValue = articleSelect.value;
  compareText.value = articles[`${selectedValue}`];
});

// ç‚¹å‡»æŸ¥é‡æŒ‰é’®æ˜¾ç¤ºé‡å¤ç‡

checkPlagiarismEl.addEventListener("click", function () {
  let plagiarismRate = checkPlagiarism(originalText, compareText.value);
  plagiarismRateText.innerHTML = `é‡å¤ç‡ï¼š${(plagiarismRate * 100).toFixed(
    2
  )}%`;
});
```

```js
const stopWords = new Set(["çš„", "ä¸º", "äº†", "æ˜¯", "åœ¨", "æˆ‘", "æœ‰", "å’Œ", "å°±", "ä¸", "éƒ½", "ä¸Š", "ä¹Ÿ", "å¾ˆ", "åˆ°", "è¯´", "è¦", "å»", "ä½ ", "ä¼š", "ç€", "æ²¡æœ‰", "çœ‹", "å¥½", "è‡ªå·±", "è¿™", "å®ƒ", "ä¸", "ä»¬", "æ–­", "è®©", "ä»", "è€Œ", "åŠ", "å°†", "æ¶‰", "æ¥"]);

function hasStopWord(word) {
  return word.split("").some((char) => stopWords.has(char));
}

function splitByStopWords(text) {
  // å°†å­—ç¬¦ä¸²åˆ†å‰²æˆå•ä¸ªå­—ç¬¦ï¼Œå¹¶å­˜å‚¨åœ¨ä¸€ä¸ªæ•°ç»„ä¸­
  const words = text.split("");
  // å®šä¹‰ä¸€ä¸ªç©ºæ•°ç»„ï¼Œç”¨äºå­˜å‚¨åˆ†å‰²åçš„ç»“æœ
  const result = [];
  // å®šä¹‰å·¦æŒ‡é’ˆï¼Œåˆå§‹å€¼ä¸º0
  let left = 0;
  // éå†å•ä¸ªå­—ç¬¦çš„æ•°ç»„ï¼ŒåŒ…æ‹¬æœ€åä¸€ä¸ªä½ç½®çš„ undefined
  for (let i = 0; i <= words.length; i++) {
    // å¦‚æœå·²ç»éå†åˆ°äº†æ•°ç»„çš„æœ€åä¸€ä¸ªä½ç½®ï¼Œæˆ–è€…å½“å‰å­—ç¬¦åœ¨åœç”¨è¯é›†åˆä¸­
    if (i === words.length || stopWords.has(words[i])) {
      // å¦‚æœå·¦æŒ‡é’ˆå’Œå½“å‰æŒ‡é’ˆä¸ç›¸ç­‰ï¼Œè¯´æ˜å½“å‰ä½ç½®æ˜¯ä¸€ä¸ªåˆ†éš”ç¬¦
      if (left !== i) {
        // å°†å·¦æŒ‡é’ˆå’Œå½“å‰æŒ‡é’ˆä¹‹é—´çš„å­—ç¬¦è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å­˜å‚¨åœ¨ç»“æœæ•°ç»„ä¸­
        result.push(words.slice(left, i).join(""));
      }
      // æ›´æ–°å·¦æŒ‡é’ˆä¸ºå½“å‰ä½ç½®çš„ä¸‹ä¸€ä¸ªä½ç½®
      left = i + 1;
    }
  }
  // è¿”å›åˆ†å‰²åçš„ç»“æœæ•°ç»„
  return result;
}

/**
 * @param {Array} words  ä¼ å…¥çš„åˆ†è¯æ•°ç»„
 * @return {Array} å¤„ç†åçš„åˆ†è¯æ•°ç»„
 */
function wordSegmentation(words) {
  words = words
    .replace(/[^\u4e00-\u9fa5]+|\d+/g, " ")
    .split(" ")
    .filter((item) => item !== "");
  const resultWord = [];
  for (const item of words) {
    if (hasStopWord(item)) {
      // æ ¹æ®åœç”¨è¯ç»§ç»­åˆ†è¯
      let result = splitByStopWords(item);
      resultWord.push(...result);
    } else {
      resultWord.push(item);
    }
  }
  console.log(resultWord, "æœ€ç»ˆç»“æœ");
  return resultWord;
}

/**
 * @param {string} text1 æŸ¥è¯¢æ–‡ç« 
 * @param {string} text2 å¯¹æ¯”æ–‡ç« 
 * @return {number} plagiarismRate  ç›¸ä¼¼åº¦
 */
function checkPlagiarism(text1, text2) {
  // 1. åˆ†è¯
  words1 = wordSegmentation(text1);
  words2 = wordSegmentation(text2);

  // 2.å¯¹åˆ†è¯åçš„åŸå§‹æ–‡æœ¬å’Œå¾…æ¯”è¾ƒæ–‡æœ¬è¿›è¡Œå»é‡å¤„ç†
  const uniqueWords1 = Array.from(new Set(words1)); // åŸæ–‡åˆ†è¯åçš„æ•°ç»„
  const uniqueWords2 = Array.from(new Set(words2)); //å¯¹ç…§æ–‡ç« åˆ†è¯åçš„æ•°ç»„

  // 3.ç»Ÿè®¡ä¸¤ç¯‡æ–‡ç« çš„ç›¸åŒè¯è¯­æ•°ç›®
  let commonWordsCount = 0;
  uniqueWords1.forEach((word) => {
    if (uniqueWords2.includes(word)) {
      commonWordsCount++;
    }
  });

  // 4.è®¡ç®—é‡å¤ç‡
  const plagiarismRate = commonWordsCount / uniqueWords1.length;
  return plagiarismRate;
}

// æ£€æµ‹éœ€è¦ï¼Œè¯·å‹¿åˆ é™¤
try {
  module.exports = wordSegmentation;
} catch (e) {}

```
### 9. åå››å±Šå›½èµ›æ¶é¾™ä¸å…¬ä¸»	

```js

let game = {
  element: {
    boxs: document.querySelectorAll(".container .box"),
    bloodEle: document.querySelector("#blood span"),
    tipEle: document.querySelector(".tip"),
    gameCtl: document.querySelector("#control .btn"),
    gameStep: document.querySelector("#control .ctl-input"),
    gamePath: document.querySelector("#game-path"),
  },
  gameData: {
    step: 0,
    dragonPos: [
      1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23,
      24,
    ].filter((i) => Math.random() > 0.8), // æ¶é¾™çš„ä½ç½®
    angelPos: 20, // å¤©ä½¿çš„ä½ç½®
    randomArr: [
      0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
      21, 22, 23, 24,
    ],
    pathArr: [], // è¡¨ç¤ºè¡Œèµ°çš„è·¯å¾„æ•°ç»„
    curPos: 0, // è¡¨ç¤ºå½“å‰çš„ä½ç½®
    curBlood: 3, // è¡¨ç¤ºå½“å‰çš„è¡€é‡
  },
  events: {
    moveHandlerDebounce: null,
  },
  randomNum(start, end) {
    return Math.floor(Math.random() * (end - start + 1)) + start;
  },
  getStep(step) {
    return step ? step : Number(this.randomNum(1, 3));
  },
  // æ¸¸æˆçš„æ‰€æœ‰æ ¼å­çš„ data-index å±æ€§æŒ‰ç…§æ‘†æ”¾çš„ä½ç½®ç»„æˆäºŒç»´æ•°ç»„ï¼Œèµ·å§‹å’Œæœ€ä¸­é—´çš„æ ¼å­å•ç‹¬èµ‹å€¼
  getDyadicArray() {
    const dyadicArray = [];
    let tempArr = [];
    Array.from(this.element.boxs).forEach((box, index) => {
      let i = index % 5;
      tempArr.push(Number(box.dataset.index));
      if (i == 4) {
        dyadicArray.push(tempArr);
        tempArr = [];
      }
    });
    dyadicArray[0][0] = "start";
    dyadicArray[2][2] = "end";
    return dyadicArray;
  },
  debounce(handle, isImmediate = false, wait = 500) {
    let timer = null;
    let isDone;
    return function (...args) {
      let self = this;
      isDone = isImmediate && !timer;
      timer && clearTimeout(timer);
      timer = setTimeout(() => {
        timer = null;
        !isImmediate && handle.apply(self, args);
      }, wait);
      isDone && handle.apply(self, args);
    };
  },
  tipRender(tip) {
    const tipEle = this.element.tipEle;
    tipEle.classList.remove("hide");
    tipEle.classList.add("show");
    if (tip === "success") {
      tipEle.style.backgroundColor = "green";
      tipEle.innerText = "è¥æ•‘æˆåŠŸ";
    }
    if (tip === "warning") {
      tipEle.style.backgroundColor = "red";
      tipEle.innerText = "é‡ä¼¤ä¸æ²»";
    }
  },
  bloodCalculator(boxEle) {
    curBlood = this.gameData.curBlood;
    if (Array.from(boxEle.classList).includes("dragon")) {
      curBlood -= 2;
    }
    if (Array.from(boxEle.classList).includes("angel")) {
      curBlood += 3;
    }
    if (curBlood <= 0) {
      this.tipRender("warning");
      curBlood = 0;
      this.element.gameCtl.removeEventListener(
        "click",
        this.events.moveHandlerDebounce
      );
    }
    this.element.bloodEle.innerText = curBlood;
    this.gameData.curBlood = curBlood;
  },
  /**
   * @param {array}: getDyadicArray å¾—åˆ°çš„äºŒç»´æ•°æ®ï¼Œå­˜å‚¨åœ°å›¾ä¸Šæ¯ä¸ªboxçš„ data-index å€¼
   * @return {array}: ä¸€ç»´æ•°ç»„ï¼Œä¿å­˜ç»è¿‡çš„è·¯å¾„
   */
  mazePath(arr) {
    // TODO:å¾—åˆ°èµ·ç‚¹åˆ°ç»ˆç‚¹ç»è¿‡çš„æ¯ä¸ª box å…ƒç´ çš„ data-index çš„å€¼å¹¶ä¾æ¬¡ä¿å­˜åœ¨æ•°ç»„ä¸­
    let bottom = arr.length,
      right = arr[0].length;
    let total = bottom * right;
    const result = [];
    let left = 0,
      top = 0,
      count = 0;
    while (left < right && top < bottom) {
      //l-> r
      for (let j = left; j < right; j++) {
        result.push(arr[top][j]);
        j == right - 1 && top++;
      }
      // t-> b
      for (let i = top; i < bottom; i++) {
        result.push(arr[i][right - 1]);
        i == bottom - 1 && right--;
      }
      // r -> l
      for (let j = right - 1; j >= left; j--) {
        result.push(arr[bottom - 1][j]);
        j == left && bottom--;
      }
      // b -> t
      for (let i = bottom - 1; i >= top; i--) {
        result.push(arr[i][left]);
        i == top && left++;
      }
    }
    console.log(JSON.stringify(result.slice(0, total)));
    return result.slice(0, total);
  },
  moveHandler() {
    let step = (this.element.gameStep.value = this.getStep(this.gameData.step));
    // TODOï¼šæ ¹æ®ç‚¹å‡»è¥æ•‘åè·å¾—çš„ç‚¹æ•°ï¼Œæ­£ç¡®åˆ°è¾¾æŒ‡å®šä½ç½®è°ƒç”¨bloodCalculatorå‡½æ•°è®¡ç®—å½“å‰è¡€é‡ï¼Œåˆ°è¾¾å…¬ä¸»å¤„è°ƒç”¨ tipRender å‡½æ•°ï¼Œæ¯æ­¥çš„æ—¶é—´é—´éš”åœ¨ 200mså†…ï¼ˆå¤§äºæ­¤æ—¶é—´ä¼šå¯¼è‡´åˆ¤é¢˜å¤±è´¥ï¼‰ã€‚
    curPos = this.gameData.curPos;
    let start = curPos;
    curPos += step;
    curPos = curPos >= 24 ? 24 : curPos;
    this.gameData.curPos = curPos;
    for (let i = start; i <= curPos; i++) {
      let timer = setTimeout(() => {
        this.element.boxs.forEach((box) => {
          if (this.gameData.pathArr[i] == box.dataset.index) {
            box.classList.add("active");
            if (i == curPos) {
              this.bloodCalculator(box);
            }
          } else {
            box.classList.remove("active");
          }
        });
        if (i === 24) {
          this.tipRender("success");
        }
        timer !== null && (timer = null);
      }, (i - start) * 200);
    }
  },
  initPlay() {
    Array.from(this.element.boxs).forEach((box, index, boxs) => {
      if (index === 0) {
        box.innerText = "start";
        box.setAttribute("data-index", "start");
      } else if (index === Math.floor(boxs.length / 2)) {
        box.classList.add("princess");
        box.setAttribute("data-index", "end");
      } else {
        box.setAttribute("data-index", this.gameData.randomArr[index]);
        if (this.gameData.dragonPos.includes(index)) {
          box.classList.add("dragon");
        } else if (index == this.gameData.angelPos) {
          box.classList.add("angel");
        } else {
          box.style.backgroundColor = "#f5f5f5";
          box.innerText = `æ— å±é™©`;
        }
      }
    });
    this.element.bloodEle.innerText = this.gameData.curBlood;
    this.gameData.pathArr = this.mazePath(this.getDyadicArray());
    this.element.gamePath.innerText = JSON.stringify(this.gameData.pathArr);
    this.events.moveHandlerDebounce = this.debounce(
      this.moveHandler.bind(this)
    );
    this.element.gameCtl.addEventListener(
      "click",
      this.events.moveHandlerDebounce
    );
  },
};
```

### é«˜é¢‘è€ƒç‚¹çŸ¥è¯†ç‚¹è®²è§£ï¼š

1. form è¡¨å•æ•°æ® (å¿…é¡»è¦æŒæ¡çš„å†…å®¹)

- `let formData = new FormData(myForm);`ï¼šåˆ›å»ºäº†ä¸€ä¸ª FormData å¯¹è±¡ï¼Œå®ƒç”¨äºå°†è¡¨å•æ•°æ®ç¼–ç æˆé”®/å€¼å¯¹é›†åˆä»¥ä¾¿äºä½¿ç”¨ã€‚`myForm` æ˜¯ä¸€ä¸ªè¡¨å•å…ƒç´ çš„å¼•ç”¨ï¼Œç”¨äºæŒ‡å®šè¦ä»å“ªä¸ªè¡¨å•ä¸­è·å–æ•°æ®ã€‚

- `formData.get('name')` // è·å–è¡¨å•ä¸­ name å±æ€§çš„å€¼


2. `class` æ“ä½œï¼ˆå¿…è€ƒç‚¹ï¼Œä¸€å®šè¦æ‹¿çš„åˆ†æ•°ï¼‰

```html
<!DOCTYPE html>
<html>
<head>
  <title>Classæ“ä½œç¤ºä¾‹</title>
  <style>
    .highlight {
      background-color: yellow;
    }
  </style>
</head>
<body>

<div id="myDiv" class="highlight">è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ </div>

<script>
  // åˆ‡æ¢ç±»å
  document.getElementById("myDiv").classList.toggle("highlight");

  // æ›¿æ¢ç±»å
  document.getElementById("myDiv").classList.replace("highlight", "newHighlight");
</script>

</body>
</html>
```

3. è·å– DOM å…ƒç´ ã€è®¾ç½® DOM å†…å®¹ã€æ˜¾ç¤ºå’Œéšè—

```html
<!DOCTYPE html>
<html>
<head>
  <title>DOMæ“ä½œç¤ºä¾‹</title>
</head>
<body>

<button onclick="changeContent()">æ”¹å˜å†…å®¹</button>
<div id="myElement">è¿™æ˜¯ä¸€ä¸ªå¯æ”¹å˜å†…å®¹çš„å…ƒç´ </div>

<script>
  function changeContent() {
    document.getElementById("myElement").innerHTML = "å†…å®¹å·²æ”¹å˜ï¼";
  }

  // æ˜¾ç¤ºå…ƒç´ 
  document.getElementById("myElement").style.display = "block";

  // éšè—å…ƒç´ 
  document.getElementById("myElement").style.display = "none";
</script>

</body>
</html>
```

4. æ–°å¢ DOM

```html
<!DOCTYPE html>
<html>
<head>
  <title>æ–°å¢DOMç¤ºä¾‹</title>
</head>
<body>

<div id="container">
  <h2>åŸå§‹å†…å®¹</h2>
  <p>è¿™æ˜¯åŸå§‹çš„æ®µè½ã€‚</p>
</div>

<button onclick="addParagraph()">æ·»åŠ æ®µè½</button>

<script>
  function addParagraph() {
    var newParagraph = document.createElement("p");
    var text = document.createTextNode("è¿™æ˜¯æ–°æ·»åŠ çš„æ®µè½ã€‚");
    newParagraph.appendChild(text);

    // å°†æ–°æ®µè½æ’å…¥åˆ°å®¹å™¨ä¸­çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ä¹‹å‰
    document.getElementById("container").insertBefore(newParagraph, document.getElementById("container").firstChild);
  }
</script>

</body>
</html>
```

5. åˆ é™¤ DOM èŠ‚ç‚¹

```html
<!DOCTYPE html>
<html>
<head>
  <title>åˆ é™¤DOMç¤ºä¾‹</title>
</head>
<body>

<div id="container">
  <h2>åŸå§‹å†…å®¹</h2>
  <p class="paragraph">è¿™æ˜¯è¦åˆ é™¤çš„æ®µè½ã€‚</p>
  <p class="paragraph">è¿™æ˜¯å¦ä¸€ä¸ªè¦åˆ é™¤çš„æ®µè½ã€‚</p>
</div>

<button onclick="deleteParagraph()">åˆ é™¤ç¬¬ä¸€ä¸ªæ®µè½</button>

<script>
  function deleteParagraph() {
    var elements = document.getElementsByClassName("paragraph");
    if (elements.length > 0) {
      elements[0].parentNode.removeChild(elements[0]);
    }
  }
</script>

</body>
</html>
```

è¿™äº›ç¤ºä¾‹æ¼”ç¤ºäº†æ›´å¤šçš„ `class` æ“ä½œã€è·å– DOM å…ƒç´ ã€è®¾ç½® DOM å†…å®¹ã€æ˜¾ç¤ºå’Œéšè—ã€æ–°å¢ DOMã€åˆ é™¤ DOM èŠ‚ç‚¹çš„æ–¹æ³•ã€‚

### æ€»ç»“ï¼š DOM  æ“ä½œ  20 - 50 åˆ†ã€‚é¢˜ç›®æ•°é‡ï¼š1 - 4ã€‚é«˜é¢‘è€ƒç‚¹ï¼š`class` æ“ä½œï¼Œè·å– dom ï¼Œè®¾ç½® DOM å†…å®¹ï¼Œæ˜¾ç¤ºå’Œéšè—ï¼Œæ–°å¢ DOM ,åˆ é™¤ DOM èŠ‚ç‚¹ã€‚

### å¤‡è€ƒå»ºè®®ï¼š DOM æ“ä½œé¢˜ç›®å åˆ†å‡è¡¡ï¼Œå¤§éƒ¨åˆ† DOM æ“ä½œé¢˜åœ¨éš¾åº¦åœ¨ä¸­ç­‰ï¼Œæ‰€æœ‰ä¸€å®šè¦å°½é‡æ‹¿åˆ†ã€‚


## axiosã€ajaxã€fetch è€ƒç‚¹  

éš¾åº¦ï¼šâ­ï¸ åˆ° â­ï¸â­ï¸

æ€»ç»“ï¼š`axios` è€ƒç‚¹ä¸ä¼šå•ç‹¬å‡ºç°ï¼Œè€Œæ˜¯åœ¨æŸé“é¢˜ç›®ä¸­ï¼Œaxios çš„è€ƒç‚¹ç›¸å¯¹ç®€å•ï¼Œå±äºå¿…é¡»æ‹¿ä¸‹çš„åˆ†æ•°ã€‚



å½“ä½ åœ¨ä½¿ç”¨ Axios å‘é€è¯·æ±‚æ—¶ï¼Œä½ å¯ä»¥è®¾ç½®è¯·æ±‚æ‹¦æˆªå™¨ï¼ˆRequest Interceptorsï¼‰å’Œå“åº”æ‹¦æˆªå™¨ï¼ˆResponse Interceptorsï¼‰ï¼Œè¿™äº›æ‹¦æˆªå™¨å¯ä»¥è®©ä½ åœ¨è¯·æ±‚å‘é€å‰å’Œå“åº”è¿”å›å‰è¿›è¡Œä¸€äº›é¢å¤–çš„æ“ä½œã€‚ä¸‹é¢æˆ‘ä¼šè¯¦ç»†è®²è§£è¿™ä¸¤ç§æ‹¦æˆªå™¨ï¼Œå¹¶æä¾›ä¸€äº›ç›¸å…³çš„ç¤ºä¾‹ã€‚

### è¯·æ±‚æ‹¦æˆªå™¨ï¼ˆRequest Interceptorsï¼‰

è¯·æ±‚æ‹¦æˆªå™¨å…è®¸ä½ åœ¨å‘é€è¯·æ±‚ä¹‹å‰å¯¹å…¶è¿›è¡Œä¿®æ”¹æˆ–æ·»åŠ ä¸€äº›è‡ªå®šä¹‰é€»è¾‘ã€‚å¸¸è§çš„ç”¨ä¾‹åŒ…æ‹¬æ·»åŠ è®¤è¯ä¿¡æ¯ã€åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šæ·»åŠ ç‰¹å®šçš„å¤´éƒ¨ã€è½¬æ¢è¯·æ±‚æ•°æ®ç­‰ã€‚

å½“æ¶‰åŠ Axios çš„è¯¦ç»†è®²è§£æ—¶ï¼Œæˆ‘ä»¬å°†è¦†ç›–ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1. å‘é€ GET è¯·æ±‚å’Œ POST è¯·æ±‚çš„ä¾‹å­ã€‚
2. è¯·æ±‚æ‹¦æˆªå™¨å’Œå“åº”æ‹¦æˆªå™¨çš„ä½¿ç”¨ã€‚
3. è®¾ç½®è¯·æ±‚å¤´å’Œå“åº”å¤´ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†å®‰è£… Axiosï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªç¤ºä¾‹ API æ¥æ¼”ç¤ºè¿™äº›åŠŸèƒ½ã€‚

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€äº› Axios çš„ä»£ç ï¼š

```javascript
const axios = require('axios');

// è®¾ç½®åŸºç¡€ URL
axios.defaults.baseURL = 'https://jsonplaceholder.typicode.com';

// è¯·æ±‚æ‹¦æˆªå™¨
axios.interceptors.request.use(config => {
  console.log('Request Interceptor');
  // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ
  return config;
}, error => {
  // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ
  return Promise.reject(error);
});

// å“åº”æ‹¦æˆªå™¨
axios.interceptors.response.use(response => {
  console.log('Response Interceptor');
  // å¯¹å“åº”æ•°æ®åšäº›ä»€ä¹ˆ
  return response;
}, error => {
  // å¯¹å“åº”é”™è¯¯åšäº›ä»€ä¹ˆ
  return Promise.reject(error);
});

// å‘é€ GET è¯·æ±‚
axios.get('/posts')
  .then(response => {
    console.log('GET Request Response:', response.data);
  })
  .catch(error => {
    console.error('GET Request Error:', error);
  });

// å‘é€ POST è¯·æ±‚
axios.post('/posts', {
    title: 'foo',
    body: 'bar',
    userId: 1
  })
  .then(response => {
    console.log('POST Request Response:', response.data);
  })
  .catch(error => {
    console.error('POST Request Error:', error);
  });
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š

- æˆ‘ä»¬é¦–å…ˆå¯¼å…¥äº† Axios æ¨¡å—ã€‚
- è®¾ç½®äº† Axios çš„é»˜è®¤åŸºç¡€ URLã€‚
- æˆ‘ä»¬å®šä¹‰äº†è¯·æ±‚æ‹¦æˆªå™¨å’Œå“åº”æ‹¦æˆªå™¨ï¼Œä»¥ä¾¿åœ¨è¯·æ±‚å‘é€å‰å’Œå“åº”è¿”å›å‰è¿›è¡Œä¸€äº›æ“ä½œã€‚
- å‘é€äº†ä¸€ä¸ª GET è¯·æ±‚å’Œä¸€ä¸ª POST è¯·æ±‚ã€‚
- å¯¹äº GET è¯·æ±‚ï¼Œæˆ‘ä»¬æ‰“å°äº†è¿”å›çš„æ•°æ®ã€‚
- å¯¹äº POST è¯·æ±‚ï¼Œæˆ‘ä»¬æ‰“å°äº†è¿”å›çš„æ•°æ®ã€‚
- åœ¨æ§åˆ¶å°ä¸­ï¼Œä½ ä¼šçœ‹åˆ°è¯·æ±‚æ‹¦æˆªå™¨å’Œå“åº”æ‹¦æˆªå™¨çš„è¾“å‡ºã€‚

åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è®¾ç½®è¯·æ±‚å¤´æˆ–å“åº”å¤´ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ·»åŠ è¿™éƒ¨åˆ†å†…å®¹ã€‚

```javascript
// å‘é€ GET è¯·æ±‚ï¼Œå¹¶è®¾ç½®è¯·æ±‚å¤´
axios.get('/posts', {
    headers: {
      'Authorization': 'Bearer token',
      'Content-Type': 'application/json'
    }
  })
  .then(response => {
    console.log('GET Request Response:', response.data);
  })
  .catch(error => {
    console.error('GET Request Error:', error);
  });

// å‘é€ POST è¯·æ±‚ï¼Œå¹¶è®¾ç½®è¯·æ±‚å¤´
axios.post('/posts', {
    title: 'foo',
    body: 'bar',
    userId: 1
  }, {
    headers: {
      'Authorization': 'Bearer token',
      'Content-Type': 'application/json'
    }
  })
  .then(response => {
    console.log('POST Request Response:', response.data);
  })
  .catch(error => {
    console.error('POST Request Error:', error);
  });
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªè¯·æ±‚è®¾ç½®äº†è¯·æ±‚å¤´ï¼Œå…¶ä¸­åŒ…æ‹¬æˆæƒä»¤ç‰Œï¼ˆAuthorizationï¼‰å’Œ Content-Typeã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ·»åŠ æˆ–ä¿®æ”¹è¯·æ±‚å¤´ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªç¤ºä¾‹è¯¦ç»†è®²è§£äº† Axios çš„ä½¿ç”¨æ–¹æ³•ï¼ŒåŒ…æ‹¬å‘é€ GET è¯·æ±‚å’Œ POST è¯·æ±‚ã€è®¾ç½®è¯·æ±‚æ‹¦æˆªå™¨å’Œå“åº”æ‹¦æˆªå™¨ã€ä»¥åŠè®¾ç½®è¯·æ±‚å¤´å’Œå“åº”å¤´ã€‚è¿™äº›åŠŸèƒ½ä½¿å¾— Axios æˆä¸ºä¸€ä¸ªéå¸¸å¼ºå¤§ä¸”çµæ´»çš„ HTTP å®¢æˆ·ç«¯åº“ã€‚


#### è®¾ç½®è¯·æ±‚æ‹¦æˆªå™¨

ä½ å¯ä»¥é€šè¿‡ `axios.interceptors.request.use()` æ–¹æ³•æ¥è®¾ç½®è¯·æ±‚æ‹¦æˆªå™¨ã€‚è¿™ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼šä¸€ä¸ªç”¨äºå¤„ç†è¯·æ±‚æˆåŠŸæ—¶çš„å›è°ƒå‡½æ•°ï¼Œå¦ä¸€ä¸ªç”¨äºå¤„ç†è¯·æ±‚å¤±è´¥æ—¶çš„å›è°ƒå‡½æ•°ã€‚

```javascript
// è®¾ç½®è¯·æ±‚æ‹¦æˆªå™¨
axios.interceptors.request.use(
  function(config) {
    // åœ¨è¯·æ±‚å‘é€ä¹‹å‰åšä¸€äº›æ“ä½œ
    console.log('Request Interceptor - Request Sent:', config);
    
    // ç¤ºä¾‹ï¼šæ·»åŠ è¯·æ±‚å¤´
    config.headers.Authorization = 'Bearer your_token_here';

    return config;
  },
  function(error) {
    // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ
    console.error('Request Interceptor - Request Error:', error);
    return Promise.reject(error);
  }
);
```

### å“åº”æ‹¦æˆªå™¨ï¼ˆResponse Interceptorsï¼‰

å“åº”æ‹¦æˆªå™¨å…è®¸ä½ åœ¨æ¥æ”¶åˆ°å“åº”æ•°æ®ä¹‹å‰å¯¹å…¶è¿›è¡Œä¿®æ”¹æˆ–æ·»åŠ ä¸€äº›è‡ªå®šä¹‰é€»è¾‘ã€‚å¸¸è§çš„ç”¨ä¾‹åŒ…æ‹¬å…¨å±€é”™è¯¯å¤„ç†ã€å¯¹å“åº”æ•°æ®è¿›è¡Œé¢„å¤„ç†ç­‰ã€‚

#### è®¾ç½®å“åº”æ‹¦æˆªå™¨

ä½ å¯ä»¥é€šè¿‡ `axios.interceptors.response.use()` æ–¹æ³•æ¥è®¾ç½®å“åº”æ‹¦æˆªå™¨ã€‚è¿™ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼šä¸€ä¸ªç”¨äºå¤„ç†æˆåŠŸå“åº”çš„å›è°ƒå‡½æ•°ï¼Œå¦ä¸€ä¸ªç”¨äºå¤„ç†å¤±è´¥å“åº”çš„å›è°ƒå‡½æ•°ã€‚

```javascript
// è®¾ç½®å“åº”æ‹¦æˆªå™¨
axios.interceptors.response.use(
  function(response) {
    // å¯¹å“åº”æ•°æ®åšäº›äº‹
    console.log('Response Interceptor - Response Received:', response);
    
    // ç¤ºä¾‹ï¼šå¯¹å“åº”æ•°æ®è¿›è¡Œå¤„ç†
    response.data = response.data.results; // å‡è®¾å“åº”æ•°æ®åœ¨ results å­—æ®µä¸­
    
    return response;
  },
  function(error) {
    // å¯¹å“åº”é”™è¯¯åšäº›ä»€ä¹ˆ
    console.error('Response Interceptor - Response Error:', error);
    return Promise.reject(error);
  }
);
```

### ç¤ºä¾‹ï¼šGET å’Œ POST è¯·æ±‚

ä¸‹é¢æ˜¯ä¸€ä¸ªåŒ…å« GET å’Œ POST è¯·æ±‚çš„ç¤ºä¾‹ï¼ŒåŒæ—¶æ¼”ç¤ºäº†è¯·æ±‚æ‹¦æˆªå™¨å’Œå“åº”æ‹¦æˆªå™¨çš„ä½¿ç”¨ã€‚

```javascript
// è®¾ç½®è¯·æ±‚æ‹¦æˆªå™¨
axios.interceptors.request.use(config => {
  // åœ¨è¯·æ±‚å‘é€ä¹‹å‰åšä¸€äº›æ“ä½œ
  console.log('Request Interceptor - Request Sent:', config);
  
  // ç¤ºä¾‹ï¼šæ·»åŠ è¯·æ±‚å¤´
  config.headers.Authorization = 'Bearer your_token_here';

  return config;
}, error => {
  // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ
  console.error('Request Interceptor - Request Error:', error);
  return Promise.reject(error);
});

// è®¾ç½®å“åº”æ‹¦æˆªå™¨
axios.interceptors.response.use(response => {
  // å¯¹å“åº”æ•°æ®åšäº›äº‹
  console.log('Response Interceptor - Response Received:', response);
  
  // ç¤ºä¾‹ï¼šå¯¹å“åº”æ•°æ®è¿›è¡Œå¤„ç†
  response.data = response.data.results; // å‡è®¾å“åº”æ•°æ®åœ¨ results å­—æ®µä¸­
  
  return response;
}, error => {
  // å¯¹å“åº”é”™è¯¯åšäº›ä»€ä¹ˆ
  console.error('Response Interceptor - Response Error:', error);
  return Promise.reject(error);
});

// å‘é€ GET è¯·æ±‚
axios.get('https://api.example.com/data')
  .then(response => {
    console.log('GET Request Response:', response.data);
  })
  .catch(error => {
    console.error('GET Request Error:', error);
  });

// å‘é€ POST è¯·æ±‚
axios.post('https://api.example.com/post', {key: 'value' })
  .then(response => {
    console.log('POST Request Response:', response.data);
  })
  .catch(error => {
    console.error('POST Request Error:', error);
  });
```

è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•è®¾ç½®è¯·æ±‚æ‹¦æˆªå™¨å’Œå“åº”æ‹¦æˆªå™¨ï¼Œå¹¶è¿›è¡Œäº† GET å’Œ POST è¯·æ±‚ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å®šåˆ¶æ‹¦æˆªå™¨çš„è¡Œä¸ºï¼Œä»¥æ»¡è¶³ç‰¹å®šçš„ä¸šåŠ¡é€»è¾‘å’Œéœ€æ±‚ã€‚

2. fetch è¯·æ±‚ï¼ˆå’ŒåŸç”Ÿ `ajax` è¯·æ±‚æŒæ¡å…¶ä¸­ä¸€ç§å†™æ³•å³å¯ï¼Œå­¦ä¹ çš„æ—¶å€™å»ºè®®éƒ½å­¦ä¹ ï¼‰
  
```html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simple Fetch Example</title>
</head>
<body>

<h2>Simple Fetch Example</h2>
<div id="response"></div>

<script>
// å‘èµ·Fetchè¯·æ±‚
fetch('https://jsonplaceholder.typicode.com/posts/1')
  .then(response => {
    // æ£€æŸ¥å“åº”çŠ¶æ€
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    // å°†å“åº”è§£æä¸ºJSONæ ¼å¼
    return response.json();
  })
  .then(data => {
    // å°†å“åº”æ•°æ®æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š
    document.getElementById('response').textContent = JSON.stringify(data);
  })
  .catch(error => {
    // å¤„ç†è¯·æ±‚é”™è¯¯
    document.getElementById('response').textContent = 'Error: ' + error.message;
  });
</script>

</body>
</html>
```

1. åŸç”Ÿ ajax è¯·æ±‚

```html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AJAX Example</title>
</head>
<body>

<button id="loadDataBtn">Load Data</button>
<div id="output"></div>

<script>
document.getElementById("loadDataBtn").addEventListener("click", function() {
  var xhr = new XMLHttpRequest();
  
  xhr.onload = function() {
    if (xhr.status >= 200 && xhr.status < 300) {
      document.getElementById("output").innerHTML = xhr.responseText;
    } else {
      document.getElementById("output").innerHTML = "Error: " + xhr.status;
    }
  };
  
  xhr.onerror = function() {
    document.getElementById("output").innerHTML = "Request failed";
  };
  
  xhr.open("GET", "example-data.txt"); // Replace "example-data.txt" with your actual URL
  xhr.send();
});
</script>

</body>
</html>
```

### å¤‡è€ƒå»ºè®®: ajax è¿™é‡Œçš„è€ƒç‚¹æ¯”è¾ƒç®€å•ï¼Œå åˆ†æ¯”ä¾‹ 5-10ï¼Œä¸€å®šè¦æ‹¿åˆ°ã€‚é‡ç‚¹å°±æ˜¯ç†Ÿæ‚‰ axios çš„ API,ä»¥åŠ fetch çš„ä½¿ç”¨ã€‚